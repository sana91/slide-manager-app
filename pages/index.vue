<template>
  <div class="container mx-auto px-4 py-8">
    <header class="mb-12 text-center">
      <h1 class="text-5xl font-bold text-primary-600 mb-4">
        ğŸ“Š Slide Manager
      </h1>
      <p class="text-xl text-gray-600 mb-8">
        HTMLã‚¹ãƒ©ã‚¤ãƒ‰ã®ç®¡ç†ãƒ»ç™»éŒ²ãƒ»é–²è¦§ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³
      </p>
      <div class="flex justify-center gap-4">
        <NuxtLink 
          to="/slides" 
          class="px-8 py-4 bg-primary-600 text-white rounded-lg font-semibold hover:bg-primary-700 transition-colors shadow-lg text-lg"
        >
          ã‚¹ãƒ©ã‚¤ãƒ‰ä¸€è¦§ã‚’è¦‹ã‚‹
        </NuxtLink>
      </div>
    </header>

    <!-- çµ±è¨ˆæƒ…å ± -->
    <div class="mb-12 grid grid-cols-1 md:grid-cols-3 gap-6">
      <div class="bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg shadow-lg p-6 text-white">
        <div class="flex items-center justify-between">
          <div>
            <p class="text-blue-100 text-sm font-medium mb-1">ç™»éŒ²ã‚¹ãƒ©ã‚¤ãƒ‰æ•°</p>
            <p class="text-4xl font-bold">{{ totalSlides }}</p>
          </div>
          <div class="text-5xl opacity-80">ğŸ“Š</div>
        </div>
      </div>
      
      <div class="bg-gradient-to-br from-green-500 to-green-600 rounded-lg shadow-lg p-6 text-white">
        <div class="flex items-center justify-between">
          <div>
            <p class="text-green-100 text-sm font-medium mb-1">ç·ãƒšãƒ¼ã‚¸æ•°</p>
            <p class="text-4xl font-bold">{{ totalPages }}</p>
          </div>
          <div class="text-5xl opacity-80">ğŸ“„</div>
        </div>
      </div>
      
      <div class="bg-gradient-to-br from-purple-500 to-purple-600 rounded-lg shadow-lg p-6 text-white">
        <div class="flex items-center justify-between">
          <div>
            <p class="text-purple-100 text-sm font-medium mb-1">æœ€çµ‚æ›´æ–°</p>
            <p class="text-lg font-semibold">{{ lastUpdateText }}</p>
          </div>
          <div class="text-5xl opacity-80">ğŸ•</div>
        </div>
      </div>
    </div>

    <!-- æ©Ÿèƒ½ç´¹ä»‹ -->
    <div class="mb-12">
      <h2 class="text-3xl font-bold text-gray-900 mb-8 text-center">ä¸»ãªæ©Ÿèƒ½</h2>
      <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
        <div class="bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow">
          <div class="text-4xl mb-4">ğŸ“</div>
          <h3 class="font-bold text-xl text-gray-900 mb-3">ã‚¹ãƒ©ã‚¤ãƒ‰ç™»éŒ²</h3>
          <p class="text-gray-600 mb-4">
            ã‚¹ãƒ©ã‚¤ãƒ‰åã¨ãƒ¦ãƒ‹ãƒ¼ã‚¯ãªã‚³ãƒ¼ãƒ‰ã‚’è¨­å®šã—ã€HTMLã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‹ã‚‰ç›´æ¥ãƒšãƒ¼ã‚¸ã‚’ä½œæˆã§ãã¾ã™ã€‚
          </p>
          <ul class="text-sm text-gray-500 space-y-1 list-disc list-inside">
            <li>ã‚¹ãƒ©ã‚¤ãƒ‰å˜ä½ã§ã®ç®¡ç†</li>
            <li>è‹±æ•°å­—ã®ã‚¹ãƒ©ã‚¤ãƒ‰ã‚³ãƒ¼ãƒ‰</li>
            <li>ãƒšãƒ¼ã‚¸ã”ã¨ã®HTMLç·¨é›†</li>
          </ul>
        </div>
        
        <div class="bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow">
          <div class="text-4xl mb-4">ğŸ“š</div>
          <h3 class="font-bold text-xl text-gray-900 mb-3">ä¸€è¦§ç®¡ç†</h3>
          <p class="text-gray-600 mb-4">
            ç™»éŒ²ã•ã‚ŒãŸã‚¹ãƒ©ã‚¤ãƒ‰ã‚’ä¸€è¦§ã§ç¢ºèªã—ã€æ¤œç´¢ã‚„ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã§ç´ æ—©ãç›®çš„ã®ã‚¹ãƒ©ã‚¤ãƒ‰ã‚’è¦‹ã¤ã‘ã‚‰ã‚Œã¾ã™ã€‚
          </p>
          <ul class="text-sm text-gray-500 space-y-1 list-disc list-inside">
            <li>æ¤œç´¢æ©Ÿèƒ½</li>
            <li>ã‚¿ã‚°ã§ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°</li>
            <li>ã‚½ãƒ¼ãƒˆæ©Ÿèƒ½</li>
          </ul>
        </div>
        
        <div class="bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow">
          <div class="text-4xl mb-4">ğŸ‘€</div>
          <h3 class="font-bold text-xl text-gray-900 mb-3">é–²è¦§ãƒ»ãƒ—ãƒ¬ã‚¼ãƒ³</h3>
          <p class="text-gray-600 mb-4">
            å„ã‚¹ãƒ©ã‚¤ãƒ‰ã¯ç‹¬è‡ªã®URLã§ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ã€‚ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã§ã‚¹ãƒ ãƒ¼ã‚ºã«ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã§ãã¾ã™ã€‚
          </p>
          <ul class="text-sm text-gray-500 space-y-1 list-disc list-inside">
            <li>ã‚¹ãƒ©ã‚¤ãƒ‰ã”ã¨ã®å°‚ç”¨URL</li>
            <li>ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³</li>
            <li>ãƒšãƒ¼ã‚¸ç•ªå·è¡¨ç¤º</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆã‚¬ã‚¤ãƒ‰ -->
    <div class="bg-gradient-to-r from-primary-50 to-blue-50 rounded-lg p-8 border border-primary-200">
      <h2 class="text-2xl font-bold text-gray-900 mb-4">ğŸš€ ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ</h2>
      <ol class="space-y-3 text-gray-700">
        <li class="flex items-start gap-3">
          <span class="flex-shrink-0 w-8 h-8 bg-primary-600 text-white rounded-full flex items-center justify-center font-bold">1</span>
          <div>
            <strong>ã‚¹ãƒ©ã‚¤ãƒ‰ã‚’ä½œæˆ:</strong> 
            <span class="text-primary-600 hover:underline">æ–°è¦ä½œæˆ</span>
            ã‹ã‚‰ã‚¹ãƒ©ã‚¤ãƒ‰åã¨ã‚¹ãƒ©ã‚¤ãƒ‰ã‚³ãƒ¼ãƒ‰ã‚’ç™»éŒ² â€»ãã‚“ãªã‚‚ã®ã¯ãªã„
          </div>
        </li>
        <li class="flex items-start gap-3">
          <span class="flex-shrink-0 w-8 h-8 bg-primary-600 text-white rounded-full flex items-center justify-center font-bold">2</span>
          <div>
            <strong>ãƒšãƒ¼ã‚¸ã‚’è¿½åŠ :</strong> ã‚¹ãƒ©ã‚¤ãƒ‰è©³ç´°ç”»é¢ã‹ã‚‰HTMLã‚³ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãƒšãƒ¼ã‚¸ã‚’è¿½åŠ 
          </div>
        </li>
        <li class="flex items-start gap-3">
          <span class="flex-shrink-0 w-8 h-8 bg-primary-600 text-white rounded-full flex items-center justify-center font-bold">3</span>
          <div>
            <strong>ãƒ—ãƒ¬ã‚¼ãƒ³:</strong> ç”Ÿæˆã•ã‚ŒãŸURLï¼ˆ/slide/ã‚³ãƒ¼ãƒ‰/ãƒšãƒ¼ã‚¸ç•ªå·ï¼‰ã§ã‚¹ãƒ©ã‚¤ãƒ‰ã‚’è¡¨ç¤º
          </div>
        </li>
      </ol>
    </div>
  </div>
</template>

<script setup lang="ts">
// Headè¨­å®š
useHead({
  title: 'ãƒ›ãƒ¼ãƒ '
})

interface SlideStats {
  totalSlides: number
  totalPages: number
  lastUpdate: string | null
}

// é–‹ç™ºæ™‚ã¯APIã€æœ¬ç•ªï¼ˆSPAï¼‰ã§ã¯JSONãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚€
// APIãŒå¤±æ•—ã—ãŸå ´åˆã¯JSONãƒ•ã‚¡ã‚¤ãƒ«ã«ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
const isDev = import.meta.dev
const apiUrl = isDev ? '/api/slides/stats' : '/api/slides/stats.json'
const jsonUrl = '/api/slides/stats.json'

// çµ±è¨ˆæƒ…å ±ã‚’å–å¾—
let fetchResult = await useFetch<SlideStats>(apiUrl)

// APIãŒå¤±æ•—ã—ãŸå ´åˆã¯JSONãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚€
if (fetchResult.error.value && fetchResult.error.value.statusCode === 404) {
  fetchResult = await useFetch<SlideStats>(jsonUrl)
}

const { data: stats, pending } = fetchResult

// çµ±è¨ˆæƒ…å ±
const totalSlides = computed(() => stats.value?.totalSlides ?? 0)
const totalPages = computed(() => stats.value?.totalPages ?? 0)

const lastUpdateText = computed(() => {
  if (!stats.value?.lastUpdate) return 'â€”'
  
  const latest = new Date(stats.value.lastUpdate)
  const now = new Date()
  const diff = now.getTime() - latest.getTime()
  const days = Math.floor(diff / (1000 * 60 * 60 * 24))
  
  if (days === 0) return 'ä»Šæ—¥'
  if (days === 1) return 'æ˜¨æ—¥'
  if (days < 7) return `${days}æ—¥å‰`
  
  return latest.toLocaleDateString('ja-JP', { month: 'short', day: 'numeric' })
})
</script>

<style scoped>
.line-clamp-2 {
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}
</style>
